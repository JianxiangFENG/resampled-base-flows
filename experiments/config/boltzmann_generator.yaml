# Config file specifying the setup of a Boltzmann Generator
# based on a Real NVP flow model


data_path:
  train: null                       # String, path to the data used for training and to initialize transform
  test: null                        # String, path to the data used for evaluation


system:                             # Properties of molecular system

  name: AlanineDipeptideVacuum      # String, specifying the system from which states shall be generated
  constraints: False                # Flag, true if constraints shall be used
  temperature: 1000                 # Double, temperature of the system
  energy_cut: 1.e+8                 # Double, energy level at which regularization shall be applied
  energy_max: 1.e+20                # Double, maximum level at which energies will be clamped
  platform: Reference               # String, specifies the platform used for force and energy calculations
  precision: double                 # String, specifies the precision used for force and energy calculations
  parallel_energy: True             # Bool, flag whether to process the batch in parallel to get energy
  n_threads: 4                      # Int, number of threads to be used, number of cores if null


model:                              # Properties of the model

  base:                             # Base distribution
    type: resampled                 # Type of the base dist, can be 'gaussian' or 'resampled'
    learn_mean_var: True            # Flag, if true, mean and variance of the dist is learned
    params:
      T: 100                        # Truncation parameter for rejection sampling
      eps: 0.05                     # Value to be used for exponential averaging
      a_hidden_layers: 2            # Hidden layers of the NN determining a
      a_hidden_units: 512           # Hidden units in the hidden layers of the NN determining a
  transform: False                  # Flag, if true, coordinate transform is added as last flow layer
  latent_size: 60                   # Int, number of features in the latent space
  blocks: 16                        # Int, number of Real NVP blocks, consisting of an ActNorm layer
                                    # if specified, a permutation, and a affine coupling layer
  actnorm: True                     # Bool, flag whether to include an ActNorm layers
  permutation: swap                 # String, can be swap, shuffle, or affine
  coupling: affine                  # String, can be affine or additive
  hidden_layers: 2                  # Int, number of hidden layers of the NN in the coupling layers
  hidden_units: 128                 # Int, number of hidden units of the NN in the coupling layers
  init_zeros: True                  # Bool, flag whether to initialize last layer of NNs with zeros


train:                              # Properties of the training procedure
  max_iter: 15000                   # Int, maximum number of iteration
  batch_size: 256                   # Int, batch size used during training
  angle_loss: False                 # Flag, true if angle loss shall be included
  learning_rate: 1.e-4              # Double, learning rate used during training
  rate_decay: 0.25                  # Double, learning rate decay factor
  decay_iter: 5000                  # Int, number of iteration after which the learning rate should be
                                    # decreased
  weight_decay: 1.e-5               # Double, regularization parameter
  checkpoint_iter: 100              # Int, number of iterations after which checkpoint is saved
  checkpoint_root: ./               # String, path to checkpoint directory