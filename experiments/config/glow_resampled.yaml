# Config file specifying the setup and the training procedure
# of the Glow model

dataset:
  name: cifar10           # Dataset to train on, can be cifar10
  path: dataset           # Path to dataset

model:
  base:                   # Base distributions of the flow model
    type: resampled_channel   # Type of the base distributions
    params:               # Parameters to be provided
      T: 100              # Truncation parameter for rejection sampling
      eps: 0.05           # Value to be used for exponential averaging
      a_hidden_layers: 2  # Hidden layers of the NN determining a
      a_hidden_units: 128 # Hidden units in the hidden layers of the NN determining a
      same_dist: True     # Flag whether to use same distribution for each factorized group
  transform:              # Transform to be applied to the image
    type: logit           # Type of the transformation
    param: 0.05           # Parameters needed
  levels: 3               # Number of levels of the multiscale architecture
  blocks: 16              # Number of flow blocks per level
  hidden_channels: 256    # Number of hidden channels in the ConvNet of the coupling layers
  scale: True             # Flag whether to include scale parameter in coupling layers
  split_mode: channel     # Method to split features in coupling layers
  class_cond: True        # Flag whether model shall be class conditional
  use_lu: False           # Flag whether to use LU decomposition in Inv1x1Conv layers

training:
  max_iter: 1000          # Maximum number of iterations
  warmup_iter: 1000       # Number of iterations of linearly warm up learning rate
  batch_size: 128         # Batch size for training and evalutation while training
  lr: 1.e-3               # Learning rate
  weight_decay: 1.e-2     # Weight decay parameter
  q0_weight_decay: 1.e-4  # Weight decay of the base distribution
  cp_iter: 100            # Number of iterations at which to save a checkpoint and samples
  num_samples: 10         # Number of samples to generate and save per checkpoint
  sample_temperature:     # Additional temperature(s) to be used for sampling
    - 0.7
    - 0.8
    - 0.9
  log_iter: 50            # Number of iterations at which to save loss and bits per dim to file
  save_root: ./           # Path where to save checkpoints, loss, and samples
  seed: null              # Seed for training run